<div class="category-management-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>
        <span class="icon">ğŸ“¦</span>
        GestiÃ³n de CategorÃ­as
      </h1>
      <p class="subtitle">Administra las categorÃ­as de productos del menÃº</p>
    </div>
    <button class="btn-primary" (click)="openCreateModal()" [disabled]="isLoading()">
      <span class="btn-icon">+</span>
      Nueva CategorÃ­a
    </button>
  </div>

  <!-- Loading Spinner -->
  <app-loading 
    [isLoading]="isLoading()" 
    [fullscreen]="false"
    message="Cargando categorÃ­as...">
  </app-loading>

  <!-- Tabla de CategorÃ­as -->
  <div class="card">
    <div class="card-header">
      <h2>Lista de CategorÃ­as</h2>
      <span class="badge">{{ categories().length }} categorÃ­as</span>
    </div>

    <div class="table-container" *ngIf="!isLoading()">
      <table class="data-table" *ngIf="categories().length > 0; else noCategories">
        <thead>
          <tr>
            <th>ID</th>
            <th>CategorÃ­a</th>
            <th>Nombre</th>
            <th class="text-center">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let category of categories(); let i = index; trackBy: trackByCategoryId">
            <td>
              <span class="category-id">#{{ category.categoryId }}</span>
            </td>
            <td>
              <div class="category-preview">
                <span class="category-badge" [class]="getCategoryClass(i)">
                  <span class="category-icon">{{ getCategoryIcon(category.name) }}</span>
                  {{ category.name }}
                </span>
              </div>
            </td>
            <td>
              <span class="category-name-text">{{ category.name }}</span>
            </td>
            <td class="actions">
              <button 
                class="btn-action btn-edit"
                (click)="openEditModal(category)"
                [disabled]="isLoading()"
                title="Editar categorÃ­a">
                âœï¸ Editar
              </button>
              <button 
                class="btn-action btn-delete"
                (click)="deleteCategory(category)"
                [disabled]="isLoading()"
                title="Eliminar categorÃ­a">
                ğŸ—‘ï¸ Eliminar
              </button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Empty State -->
      <ng-template #noCategories>
        <div class="empty-state">
          <div class="empty-icon">ğŸ“¦</div>
          <h3>No hay categorÃ­as registradas</h3>
          <p>Las categorÃ­as ayudan a organizar el menÃº de productos</p>
          <div class="example-list">
            <p><strong>Ejemplos de categorÃ­as:</strong></p>
            <ul>
              <li>ğŸ¥¤ Bebidas</li>
              <li>ğŸ½ï¸ Platos Fuertes</li>
              <li>ğŸ¥— Entradas</li>
              <li>ğŸ° Postres</li>
              <li>ğŸ• Pizzas</li>
              <li>â˜• CafÃ©</li>
            </ul>
          </div>
          <button class="btn-primary" (click)="openCreateModal()">
            <span class="btn-icon">+</span>
            Crear Primera CategorÃ­a
          </button>
        </div>
      </ng-template>
    </div>
  </div>

  <!-- Modal de Crear/Editar -->
  <div class="modal-overlay" *ngIf="showModal()" (click)="closeModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>
          <span class="modal-icon">{{ isEditing() ? 'âœï¸' : 'â•' }}</span>
          {{ isEditing() ? 'Editar CategorÃ­a' : 'Nueva CategorÃ­a' }}
        </h2>
        <button class="btn-close" (click)="closeModal()" [disabled]="isLoading()">
          âœ•
        </button>
      </div>

      <div class="modal-body">
        <form (ngSubmit)="saveCategory()" #categoryForm="ngForm">
          <!-- ID (solo en modo ediciÃ³n) -->
          <div class="form-group" *ngIf="isEditing()">
            <label>ID de la CategorÃ­a</label>
            <input 
              type="text" 
              [value]="currentCategory().categoryId" 
              disabled
              class="form-control">
          </div>

          <!-- Vista Previa de la CategorÃ­a -->
          <div class="form-group" *ngIf="currentCategory().name.trim()">
            <label>Vista Previa</label>
            <div class="category-preview-box">
              <span class="category-badge cat-preview">
                <span class="category-icon">{{ getCategoryIcon(currentCategory().name) }}</span>
                {{ currentCategory().name }}
              </span>
            </div>
          </div>

          <!-- Nombre de la CategorÃ­a -->
          <div class="form-group">
            <label for="categoryName">
              <span class="required">*</span>
              Nombre de la CategorÃ­a
            </label>
            <input 
              type="text"
              id="categoryName"
              name="categoryName"
              [ngModel]="currentCategory().name"
              (ngModelChange)="updateCategoryName($event)"
              required
              maxlength="20"
              placeholder="Ej: Bebidas, Platos Fuertes, Postres"
              class="form-control"
              [disabled]="isLoading()"
              #categoryNameInput="ngModel">
            
            <div class="form-hint" *ngIf="!categoryNameInput.errors">
              {{ currentCategory().name.length }}/20 caracteres
            </div>
            
            <div class="form-error" *ngIf="categoryNameInput.touched && categoryNameInput.errors?.['required']">
              El nombre de la categorÃ­a es requerido
            </div>

            <div class="form-info">
              <strong>ğŸ’¡ Tip:</strong> Usa nombres descriptivos y cortos (mÃ¡x. 20 caracteres)
            </div>
          </div>

          <!-- Ejemplos de CategorÃ­as Comunes -->
          <div class="examples-section">
            <h4>ğŸ½ï¸ CategorÃ­as Comunes:</h4>
            <div class="example-badges">
              <span class="example-badge" (click)="updateCategoryName('Bebidas')">ğŸ¥¤ Bebidas</span>
              <span class="example-badge" (click)="updateCategoryName('Entradas')">ğŸ¥— Entradas</span>
              <span class="example-badge" (click)="updateCategoryName('Platos Fuertes')">ğŸ– Platos Fuertes</span>
              <span class="example-badge" (click)="updateCategoryName('Postres')">ğŸ° Postres</span>
              <span class="example-badge" (click)="updateCategoryName('Pizzas')">ğŸ• Pizzas</span>
              <span class="example-badge" (click)="updateCategoryName('Pasta')">ğŸ Pasta</span>
              <span class="example-badge" (click)="updateCategoryName('Ensaladas')">ğŸ¥— Ensaladas</span>
              <span class="example-badge" (click)="updateCategoryName('CafÃ©')">â˜• CafÃ©</span>
              <span class="example-badge" (click)="updateCategoryName('CÃ³cteles')">ğŸ¹ CÃ³cteles</span>
            </div>
          </div>

          <!-- Botones -->
          <div class="modal-actions">
            <button 
              type="button" 
              class="btn-secondary"
              (click)="closeModal()"
              [disabled]="isLoading()">
              Cancelar
            </button>
            <button 
              type="submit" 
              class="btn-primary"
              [disabled]="!categoryForm.valid || isLoading()">
              <span *ngIf="!isLoading()">
                {{ isEditing() ? 'ğŸ’¾ Actualizar' : 'â• Crear' }}
              </span>
              <span *ngIf="isLoading()">
                Guardando...
              </span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>



