import{b as N,c as D,d as L,e as V,f as T,g as F,n as q,q as $,r as j}from"./chunk-5I2LB5G5.js";import{b as A}from"./chunk-BQTDLULF.js";import{Ab as S,Ca as v,Ga as _,Hb as I,Oa as c,Pa as n,Pb as z,Qa as t,R as h,Ra as O,Sa as b,Ta as g,Ua as s,Va as C,W as m,X as p,Xa as y,Ya as a,Za as E,_a as f,a as M,b as P,ca as u,ib as w,pa as d,xb as R,yb as k}from"./chunk-5IEPMVD6.js";function Y(l,r){if(l&1){let e=b();n(0,"tr")(1,"td")(2,"span",21),a(3),t()(),n(4,"td")(5,"div",22)(6,"span",23),a(7),t()()(),n(8,"td",24)(9,"button",25),g("click",function(){let i=m(e).$implicit,x=s(3);return p(x.openEditModal(i))}),a(10," \u270F\uFE0F Editar "),t(),n(11,"button",26),g("click",function(){let i=m(e).$implicit,x=s(3);return p(x.deleteRole(i))}),a(12," \u{1F5D1}\uFE0F Eliminar "),t()()()}if(l&2){let e=r.$implicit,o=s(3);d(3),f("#",e.roleId),d(3),y(e.name.toLowerCase()),d(),f(" ",e.name," "),d(2),c("disabled",o.isLoading()),d(2),c("disabled",o.isLoading())}}function G(l,r){if(l&1&&(n(0,"table",18)(1,"thead")(2,"tr")(3,"th"),a(4,"ID"),t(),n(5,"th"),a(6,"Nombre"),t(),n(7,"th",19),a(8,"Acciones"),t()()(),n(9,"tbody"),_(10,Y,13,6,"tr",20),t()()),l&2){let e=s(2);d(10),c("ngForOf",e.roles())("ngForTrackBy",e.trackByRoleId)}}function U(l,r){if(l&1){let e=b();n(0,"div",27)(1,"div",28),a(2,"\u{1F4CB}"),t(),n(3,"h3"),a(4,"No hay roles registrados"),t(),n(5,"p"),a(6,"Comienza creando tu primer rol"),t(),n(7,"button",29),g("click",function(){m(e);let i=s(2);return p(i.openCreateModal())}),n(8,"span",9),a(9,"+"),t(),a(10," Crear Primer Rol "),t()()}}function W(l,r){if(l&1&&(n(0,"div",16),_(1,G,11,2,"table",17)(2,U,11,0,"ng-template",null,0,w),t()),l&2){let e=C(3),o=s();d(),c("ngIf",o.roles().length>0)("ngIfElse",e)}}function H(l,r){if(l&1&&(n(0,"div",38)(1,"label"),a(2,"ID del Rol"),t(),O(3,"input",48),t()),l&2){let e=s(2);d(3),c("value",e.currentRole().roleId)}}function J(l,r){if(l&1&&(n(0,"div",49),a(1),t()),l&2){let e=s(2);d(),f(" ",e.currentRole().name.length,"/20 caracteres ")}}function K(l,r){l&1&&(n(0,"div",50),a(1," El nombre del rol es requerido "),t())}function Q(l,r){if(l&1&&(n(0,"span"),a(1),t()),l&2){let e=s(2);d(),f(" ",e.isEditing()?"\u{1F4BE} Actualizar":"\u2795 Crear"," ")}}function X(l,r){l&1&&(n(0,"span"),a(1," Guardando... "),t())}function Z(l,r){if(l&1){let e=b();n(0,"div",30),g("click",function(){m(e);let i=s();return p(i.closeModal())}),n(1,"div",31),g("click",function(i){return m(e),p(i.stopPropagation())}),n(2,"div",32)(3,"h2")(4,"span",33),a(5),t(),a(6),t(),n(7,"button",34),g("click",function(){m(e);let i=s();return p(i.closeModal())}),a(8," \u2715 "),t()(),n(9,"div",35)(10,"form",36,1),g("ngSubmit",function(){m(e);let i=s();return p(i.saveRole())}),_(12,H,4,1,"div",37),n(13,"div",38)(14,"label",39)(15,"span",40),a(16,"*"),t(),a(17," Nombre del Rol "),t(),n(18,"input",41,2),g("ngModelChange",function(i){m(e);let x=s();return p(x.updateRoleName(i))}),t(),_(20,J,2,1,"div",42)(21,K,2,0,"div",43),t(),n(22,"div",44)(23,"button",45),g("click",function(){m(e);let i=s();return p(i.closeModal())}),a(24," Cancelar "),t(),n(25,"button",46),_(26,Q,2,1,"span",47)(27,X,2,0,"span",47),t()()()()()()}if(l&2){let e=C(11),o=C(19),i=s();d(5),E(i.isEditing()?"\u270F\uFE0F":"\u2795"),d(),f(" ",i.isEditing()?"Editar Rol":"Nuevo Rol"," "),d(),c("disabled",i.isLoading()),d(5),c("ngIf",i.isEditing()),d(6),c("ngModel",i.currentRole().name)("disabled",i.isLoading()),d(2),c("ngIf",!o.errors),d(),c("ngIf",o.touched&&(o.errors==null?null:o.errors.required)),d(2),c("disabled",i.isLoading()),d(2),c("disabled",!e.valid||i.isLoading()),d(),c("ngIf",!i.isLoading()),d(),c("ngIf",i.isLoading())}}var B=class l{roleService=h(I);notificationService=h(z);roles=u([]);isLoading=u(!1);showModal=u(!1);isEditing=u(!1);currentRole=u({name:""});ngOnInit(){this.loadRoles()}loadRoles(){this.isLoading.set(!0),this.roleService.getAll().subscribe({next:r=>{this.roles.set(r),this.isLoading.set(!1)},error:r=>{console.error("Error al cargar roles:",r),this.notificationService.error("Error al cargar los roles"),this.isLoading.set(!1)}})}openCreateModal(){this.currentRole.set({name:""}),this.isEditing.set(!1),this.showModal.set(!0)}openEditModal(r){this.currentRole.set(M({},r)),this.isEditing.set(!0),this.showModal.set(!0)}closeModal(){this.showModal.set(!1),this.currentRole.set({name:""}),this.isEditing.set(!1)}saveRole(){let r=this.currentRole();if(!r.name.trim()){this.notificationService.warning("El nombre del rol es requerido");return}this.isLoading.set(!0),(this.isEditing()?this.roleService.update(r):this.roleService.create(r)).subscribe({next:o=>{let i=this.isEditing()?`Rol "${o.name}" actualizado exitosamente`:`Rol "${o.name}" creado exitosamente`;this.notificationService.success(i),this.closeModal(),this.loadRoles()},error:o=>{console.error("Error al guardar rol:",o);let i=this.isEditing()?"actualizar":"crear";this.notificationService.error(`Error al ${i} el rol`),this.isLoading.set(!1)}})}deleteRole(r){if(!r.roleId){this.notificationService.error("ID de rol no v\xE1lido");return}let e=`\xBFEst\xE1 seguro de eliminar el rol "${r.name}"?

Esta acci\xF3n no se puede deshacer.`;confirm(e)&&(this.isLoading.set(!0),this.roleService.delete(r.roleId).subscribe({next:()=>{this.notificationService.success(`Rol "${r.name}" eliminado exitosamente`),this.loadRoles()},error:o=>{console.error("Error al eliminar rol:",o),o.status===409||o.status===500?this.notificationService.error("No se puede eliminar el rol porque est\xE1 siendo usado por usuarios"):this.notificationService.error("Error al eliminar el rol"),this.isLoading.set(!1)}}))}updateRoleName(r){this.currentRole.update(e=>P(M({},e),{name:r}))}trackByRoleId(r,e){return e.roleId}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-role-management"]],decls:22,vars:6,consts:[["noRoles",""],["roleForm","ngForm"],["roleNameInput","ngModel"],[1,"role-management-container"],[1,"page-header"],[1,"header-content"],[1,"icon"],[1,"subtitle"],[1,"btn-primary",3,"click","disabled"],[1,"btn-icon"],["message","Cargando roles...",3,"isLoading","fullscreen"],[1,"card"],[1,"card-header"],[1,"badge"],["class","table-container",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"table-container"],["class","data-table",4,"ngIf","ngIfElse"],[1,"data-table"],[1,"text-center"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"role-id"],[1,"role-name"],[1,"role-badge"],[1,"actions"],["title","Editar rol",1,"btn-action","btn-edit",3,"click","disabled"],["title","Eliminar rol",1,"btn-action","btn-delete",3,"click","disabled"],[1,"empty-state"],[1,"empty-icon"],[1,"btn-primary",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-icon"],[1,"btn-close",3,"click","disabled"],[1,"modal-body"],[3,"ngSubmit"],["class","form-group",4,"ngIf"],[1,"form-group"],["for","roleName"],[1,"required"],["type","text","id","roleName","name","roleName","required","","maxlength","20","placeholder","Ej: Admin, Waiter, Chef",1,"form-control",3,"ngModelChange","ngModel","disabled"],["class","form-hint",4,"ngIf"],["class","form-error",4,"ngIf"],[1,"modal-actions"],["type","button",1,"btn-secondary",3,"click","disabled"],["type","submit",1,"btn-primary",3,"disabled"],[4,"ngIf"],["type","text","disabled","",1,"form-control",3,"value"],[1,"form-hint"],[1,"form-error"]],template:function(e,o){e&1&&(n(0,"div",3)(1,"div",4)(2,"div",5)(3,"h1")(4,"span",6),a(5,"\u{1F465}"),t(),a(6," Gesti\xF3n de Roles "),t(),n(7,"p",7),a(8,"Administra los roles del sistema"),t()(),n(9,"button",8),g("click",function(){return o.openCreateModal()}),n(10,"span",9),a(11,"+"),t(),a(12," Nuevo Rol "),t()(),O(13,"app-loading",10),n(14,"div",11)(15,"div",12)(16,"h2"),a(17,"Lista de Roles"),t(),n(18,"span",13),a(19),t()(),_(20,W,4,2,"div",14),t(),_(21,Z,28,12,"div",15),t()),e&2&&(d(9),c("disabled",o.isLoading()),d(4),c("isLoading",o.isLoading())("fullscreen",!1),d(6),f("",o.roles().length," roles"),d(),c("ngIf",!o.isLoading()),d(),c("ngIf",o.showModal()))},dependencies:[S,R,k,j,F,N,D,L,q,$,T,V,A],styles:['@charset "UTF-8";.role-management-container[_ngcontent-%COMP%]{padding:30px;max-width:1200px;margin:0 auto;min-height:100vh;background:#f7fafc}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;flex-wrap:wrap;gap:20px}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:2rem;color:#2d3748}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2.5rem}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:8px 0 0;color:#718096;font-size:1rem}.card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 10px #00000014;overflow:hidden}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px 30px;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;color:#2d3748}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#667eea;color:#fff;padding:6px 14px;border-radius:20px;font-size:.85rem;font-weight:600}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f7fafc}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px 20px;text-align:left;font-weight:600;color:#4a5568;font-size:.9rem;text-transform:uppercase;letter-spacing:.05em;border-bottom:2px solid #e2e8f0}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.text-center[_ngcontent-%COMP%]{text-align:center}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f7fafc}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid #e2e8f0}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:20px;color:#2d3748}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.actions[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.role-id[_ngcontent-%COMP%]{font-weight:600;color:#667eea;font-family:Courier New,monospace}.role-name[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.role-badge[_ngcontent-%COMP%]{display:inline-block;padding:6px 14px;border-radius:6px;font-weight:600;font-size:.9rem;text-transform:capitalize}.role-badge.admin[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f093fb,#f5576c);color:#fff}.role-badge.waiter[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe);color:#fff}.role-badge.chef[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b,#38f9d7);color:#fff}.role-badge[_ngcontent-%COMP%]:not(.admin):not(.waiter):not(.chef){background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;padding:12px 24px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px;font-size:1rem}.btn-primary[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #667eea66}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#4a5568;border:2px solid #e2e8f0;padding:12px 24px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease;font-size:1rem}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#f7fafc;border-color:#cbd5e0}.btn-secondary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-action[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;border:none;font-weight:500;cursor:pointer;transition:all .3s ease;font-size:.9rem;margin:0 4px}.btn-action[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-edit[_ngcontent-%COMP%]{background:#4299e1;color:#fff}.btn-edit[_ngcontent-%COMP%]:hover:not(:disabled){background:#3182ce;transform:translateY(-2px);box-shadow:0 4px 12px #4299e166}.btn-delete[_ngcontent-%COMP%]{background:#f56565;color:#fff}.btn-delete[_ngcontent-%COMP%]:hover:not(:disabled){background:#e53e3e;transform:translateY(-2px);box-shadow:0 4px 12px #f5656566}.empty-state[_ngcontent-%COMP%]{padding:80px 40px;text-align:center}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:5rem;margin-bottom:20px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2d3748;margin:0 0 10px;font-size:1.5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;margin:0 0 30px;font-size:1rem}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;justify-content:center;align-items:center;z-index:1000;padding:20px;animation:_ngcontent-%COMP%_fadeIn .3s ease}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;width:100%;max-width:500px;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{padding:24px 30px;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:1.5rem;display:flex;align-items:center;gap:10px}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   .modal-icon[_ngcontent-%COMP%]{font-size:1.8rem}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.8rem;color:#718096;cursor:pointer;padding:0;width:32px;height:32px;border-radius:50%;transition:all .3s ease}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover:not(:disabled){background:#f7fafc;color:#2d3748}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:30px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#4a5568;font-weight:600;font-size:.95rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#e53e3e;margin-right:4px}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e2e8f0;border-radius:8px;font-size:1rem;transition:all .3s ease;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:disabled{background:#f7fafc;cursor:not-allowed;opacity:.6}.form-group[_ngcontent-%COMP%]   .form-hint[_ngcontent-%COMP%]{margin-top:6px;font-size:.85rem;color:#718096}.form-group[_ngcontent-%COMP%]   .form-error[_ngcontent-%COMP%]{margin-top:6px;font-size:.85rem;color:#e53e3e;display:flex;align-items:center;gap:4px}.form-group[_ngcontent-%COMP%]   .form-error[_ngcontent-%COMP%]:before{content:"\\26a0\\fe0f"}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:30px}.modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.role-management-container[_ngcontent-%COMP%]{padding:20px}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.page-header[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{width:100%;justify-content:center}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;font-size:.9rem}.btn-action[_ngcontent-%COMP%]{padding:6px 12px;font-size:.85rem}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px}}']})};export{B as RoleManagementComponent};
